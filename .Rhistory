#install.packages("dplyr")
library("dplyr")
library("stats")
Itemset<- read.csv("/home/amro/Documents/Fall-22 Class Material/Data Science + R/Final Project/grcDataset-master/grc.csv")
Itemset<- read.csv("/home/amro/Documents/College/Fall-22 Class Material/Data Science + R/Final Project/grcDataset-master")
Itemset<- read.csv("/home/amro/Documents/College/Fall-22 Class Material/Data Science + R/Final Project/grcDataset-master/grc.csv")
View(Itemset)
Itemset<- select(Itemset, items, count, customer, age, city, total, paymentType)
pie(
x= table(Itemset$paymentType),
main = "Compare Cash & Credit Total Spending"
)
totalAge<- group_by(Itemset, age)
totalAge<- summarize(totalAge, total=sum(total))
plot(
x= totalAge$age,
y= totalAge$total,
main = "Age VS. Total Spending",
xlab = "Age",
ylab = "Total"
)
View(totalAge)
totalCity<- group_by(Itemset, city)
totalCity<- summarize(totalCity, total=sum(total))
totalCity<- arrange(totalCity, desc(total))
barplot(
height = totalCity$total,
names = totalCity$city,
col = "light green",
main = "Compare Cities Total Spending",
xlab = "City",
ylab = "Total",
horiz = F,
axes = T,
las = 1
)
boxplot(
x= Itemset$total,
main = "Distribution of Total Spending",
xlab = "Total"
)
summary(Itemset)
par(mfrow=c(2,2))
pie(
x= table(Itemset$paymentType),
main = "Compare Cash & Credit Total Spending"
)
plot(
x= totalAge$age,
y= totalAge$total,
main = "Age VS. Total Spending",
xlab = "Age",
ylab = "Total"
)
barplot(
height = totalCity$total,
names = totalCity$city,
beside = F,
col = "light green",
main = "Compare Cities Total Spending",
xlab = "City",
ylab = "Total",
horiz = F,
axes = T,
las = 1
)
boxplot(
x= Itemset$total,
main = "Distribution of Total Spending",
xlab = "Total"
)
filtItemset<- select(Itemset, customer, age, total)
filtItemset<- group_by(filtItemset, customer, age)
filtItemset<- summarize(filtItemset, total=sum(total))
View(filtItemset)
kmTable<-data.matrix(filtItemset)
kmpTable<- cbind(kmTable[,2],kmTable[,3])
kmpTable
n<- as.numeric(readline("Enter number of groups:"))
im<- as.numeric(readline("Enter number of iterations:"))
if (n>=2 & n<=4){
KM <- kmeans(kmpTable, centers = n, iter.max = im)
} else {
print("Try a number between 2-4!")
}
km
KM
clstrs<-as.vector(KM$cluster)
filtItemset$group<-clstrs
View(filtItemset)
wssplot <- function(data, nc=15, seed=1234){
wss <- (nrow(data)-1)*sum(apply(data,2,var))
for (i in 1:nc){
set.seed(seed)
wss[i] <- sum(kmeans(data, centers=i)$withinss)}
plot(1:nc, wss, type="b", xlab="Number of Clusters",
ylab="Within groups sum of squares")
}
wssplot(filtItemset)
filtItemset<- select(Itemset, customer, age, total)
filtItemset<- group_by(filtItemset, customer, age)
filtItemset<- summarize(filtItemset, total=sum(total))
wssplot(filtItemset)
?wssplot
#youtube packages for kmeans
install.packages("ggplot2")
install.packages("ggfortify")
library("ggplot2")
library("ggfortify")
install.packages("NbClust")
library("NbClust")
wssplot <- function(data, nc=15, seed=1234){
wss <- (nrow(data)-1)*sum(apply(data,2,var))
for (i in 1:nc){
set.seed(seed)
wss[i] <- sum(kmeans(data, centers=i)$withinss)}
plot(1:nc, wss, type="b", xlab="Number of Clusters",
ylab="Within groups sum of squares")
}
wssplot(filtItemset)
filtItemset<- select(Itemset, age, total)
wssplot(filtItemset)
filtItemset<- group_by(filtItemset, customer, age)
filtItemset<- summarize(filtItemset, total=sum(total))
wssplot(filtItemset)
filtItemset<- select(Itemset, age, total)
filtItemset<- group_by(filtItemset, age)
filtItemset<- summarize(filtItemset, total=sum(total))
wssplot(filtItemset)
wssplot <- function(data, nc=12, seed=1234){
wss <- (nrow(data)-1)*sum(apply(data,2,var))
for (i in 1:nc){
set.seed(seed)
wss[i] <- sum(kmeans(data, centers=i)$withinss)}
plot(1:nc, wss, type="b", xlab="Number of Clusters",
ylab="Within groups sum of squares")
}
wssplot(filtItemset)
wssplot <- function(data, nc=13, seed=1234){
wss <- (nrow(data)-1)*sum(apply(data,2,var))
for (i in 1:nc){
set.seed(seed)
wss[i] <- sum(kmeans(data, centers=i)$withinss)}
plot(1:nc, wss, type="b", xlab="Number of Clusters",
ylab="Within groups sum of squares")
}
wssplot(filtItemset)
wssplot <- function(data, nc=11, seed=1234){
wss <- (nrow(data)-1)*sum(apply(data,2,var))
for (i in 1:nc){
set.seed(seed)
wss[i] <- sum(kmeans(data, centers=i)$withinss)}
plot(1:nc, wss, type="b", xlab="Number of Clusters",
ylab="Within groups sum of squares")
}
wssplot(filtItemset)
filtItemset<- select(Itemset, age, count)
filtItemset<- group_by(filtItemset, age)
filtItemset<- summarize(filtItemset, total=sum(count))
wssplot(filtItemset)
filtItemset<- select(Itemset, age, total)
filtItemset<- group_by(filtItemset, age)
filtItemset<- summarize(filtItemset, total=sum(total))
as.double(filtItemset$total)
wssplot(filtItemset)
filtItemset<- select(Itemset, total, age)
filtItemset<- group_by(filtItemset, age)
filtItemset<- summarize(filtItemset, total=sum(total))
as.double(filtItemset$total)
filtItemset<- group_by(filtItemset, total, age)
filtItemset<- select(Itemset, total, age)
filtItemset<- group_by(filtItemset, total, age)
filtItemset<- summarize(filtItemset, total=sum(total))
filtItemset<- summarize(filtItemset, total=sum(total))
?summarise
filtItemset<- select(Itemset, total, age)
filtItemset<- group_by(filtItemset, total, age)
filtItemset<- summarize(filtItemset, total=sum(total), .groups = "keep")
filtItemset<- group_by(filtItemset, age)
filtItemset<- summarize(filtItemset, total=sum(total), .groups = "keep")
wssplot <- function(data, nc=15, seed=1234){
wss <- (nrow(data)-1)*sum(apply(data,2,var))
for (i in 1:nc){
set.seed(seed)
wss[i] <- sum(kmeans(data, centers=i)$withinss)}
plot(1:nc, wss, type="b", xlab="Number of Clusters",
ylab="Within groups sum of squares")
}
wssplot(filtItemset)
set.seed(seed)
wssplot <- function(data, nc=12, seed=1234){
wss <- (nrow(data)-1)*sum(apply(data,2,var,simplify =T))
for (i in 1:nc){
set.seed(seed)
wss[i] <- sum(kmeans(data, centers=i)$withinss)}
plot(1:nc, wss, type="b", xlab="Number of Clusters",
ylab="Within groups sum of squares")
}
wssplot(filtItemset)
wssplot <- function(data, nc=12, seed=1234){
wss <- (nrow(data)-1)*sum(apply(data,2,var))
for (i in 1:nc){
set.seed(seed)
wss[i] <- sum(kmeans(data, centers=i)$withinss)}
plot(1:nc, wss, type="b", xlab="Number of Clusters",
ylab="Within groups sum of squares")
}
wssplot(filtItemset)
plot(
x= totalAge$age,
y= totalAge$total,
main = "Age VS. Total Spending",
xlab = "Age",
ylab = "Total"
)
?plot
#to choose the optimum number of centersd
#wssplot(kmpTable)
#AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHH
?apply(array, margin, ...)
cfv<- c(4:1, 2:5)
cfv
?var
wss <- (nrow(data)-1)*sum(apply(data,2,cov))
wssplot <- function(data, nc=12, seed=1234){
wss <- (nrow(data)-1)*sum(apply(data,2,cov))
for (i in 1:nc){
set.seed(seed)
wss[i] <- sum(kmeans(data, centers=i)$withinss)}
plot(1:nc, wss, type="b", xlab="Number of Clusters",
ylab="Within groups sum of squares")
}
wssplot(filtItemset)
wssplot <- function(data, nc=12, seed=1234){
wss <- (nrow(data)-1)*sum(apply(data,2,cor))
for (i in 1:nc){
set.seed(seed)
wss[i] <- sum(kmeans(data, centers=i)$withinss)}
plot(1:nc, wss, type="b", xlab="Number of Clusters",
ylab="Within groups sum of squares")
}
wssplot(filtItemset)
wssplot <- function(data, nc=12, seed=1234){
wss <- (nrow(data)-1)*sum(apply(data,c(1,2),var))
for (i in 1:nc){
set.seed(seed)
wss[i] <- sum(kmeans(data, centers=i)$withinss)}
plot(1:nc, wss, type="b", xlab="Number of Clusters",
ylab="Within groups sum of squares")
}
wssplot(filtItemset)
as.double(filtItemset$total & filtItemset$age)
wssplot(filtItemset)
wssplot <- function(data, nc=12, seed=2000000){
wss <- (nrow(data)-1)*sum(apply(data,2,var))
for (i in 1:nc){
set.seed(seed)
wss[i] <- sum(kmeans(data, centers=i)$withinss)}
plot(1:nc, wss, type="b", xlab="Number of Clusters",
ylab="Within groups sum of squares")
}
wssplot(filtItemset)
filtItemset<- select(Itemset, age, total)
filtItemset<- group_by(filtItemset, age)
filtItemset<- summarize(filtItemset, total=sum(total), .groups = "keep")
as.double(filtItemset$total & filtItemset$age)
filtItemset<- select(Itemset, age, total)
filtItemset<- group_by(filtItemset, age)
filtItemset<- summarize(filtItemset, total=sum(total), .groups = "keep")
as.double(filtItemset$total)
as.double(filtItemset$age)
wssplot(filtItemset)
wssplot <- function(data, nc=11, seed=2000000){
wss <- (nrow(data)-1)*sum(apply(data,2,var))
for (i in 1:nc){
set.seed(seed)
wss[i] <- sum(kmeans(data, centers=i)$withinss)}
plot(1:nc, wss, type="b", xlab="Number of Clusters",
ylab="Within groups sum of squares")
}
wssplot(filtItemset)
wssplot <- function(data, nc=11, seed=2000000){
wss <- (nrow(data)-1)*sum(apply(data,1,var))
for (i in 1:nc){
set.seed(seed)
wss[i] <- sum(kmeans(data, centers=i)$withinss)}
plot(1:nc, wss, type="b", xlab="Number of Clusters",
ylab="Within groups sum of squares")
}
wssplot(filtItemset)
wssplot <- function(data, nc=11, seed=2000000){
wss <- (nrow(data)-1)*sum(apply(data,c(1,2),var))
for (i in 1:nc){
set.seed(seed)
wss[i] <- sum(kmeans(data, centers=i)$withinss)}
plot(1:nc, wss, type="b", xlab="Number of Clusters",
ylab="Within groups sum of squares")
}
wssplot(filtItemset)
kmTable<-data.matrix(filtItemset)
kmpTable
KM <- kmeans(kmpTable, centers = 2, iter.max = 1000)
KM
clstrs<-as.vector(KM$cluster)
filtItemset$group<-clstrs
filtItemset<- select(Itemset, age, total)
filtItemset<- group_by(filtItemset, age)
filtItemset<- summarize(filtItemset, total=sum(total), .groups = "keep")
as.double(filtItemset$age)
as.double(filtItemset$total)
kmTable<-data.matrix(filtItemset)
kmpTable
filtItemset<- select(Itemset, age, total)
filtItemset<- group_by(filtItemset, age)
filtItemset<- summarize(filtItemset, total=sum(total), .groups = "keep")
kmTable<-as.matrix(filtItemset)
kmpTable
kmpTable<- cbind(kmTable[,2],kmTable[,3])
KM <- kmeans(filtItemset, centers = 2, iter.max = 1000)
KM
clstrs<-as.vector(KM$cluster)
filtItemset$group<-clstrs
